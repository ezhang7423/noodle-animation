<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <script src="anime.min.js"></script>
  <style>
    body,
    html {
      position: absolute;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-items: center;
      width: 100%;
      height: 100vh;
      background-color: #F6F4F2;
      flex-direction: column;
    }

    .stagger-visualizer {
      display: flex;
      /* flex-wrap: wrap; */
      justify-content: center;
      align-items: center;
      width: 450px;
      height: 450px;
    }

    @media (max-width: 600px) {
      .stagger-visualizer {
        width: 90vw;
        height: 90vw;
      }
    }

    .stagger-visualizer div {
      /*position: absolute;*/
      width: 64px;
      height: 128px;
      border: 1px solid #373535;
      background-color: #F6F4F2;
    }

    .loop {
      margin: 0 30vw;
    }


    .sliders {
      display: flex;
      flex-direction: column;
      width: 200px;
    }

    .slider {
      -webkit-appearance: none;
      width: 100%;
      height: 15px;
      border-radius: 5px;
      background: #d3d3d3;
      outline: none;
      opacity: 0.7;
      -webkit-transition: .2s;
      transition: opacity .2s;
      margin-bottom: 50px;
    }

    .slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 25px;
      height: 25px;
      border-radius: 50%;
      background: #4CAF50;
      cursor: pointer;
    }

    .slider::-moz-range-thumb {
      width: 25px;
      height: 25px;
      border-radius: 50%;
      background: #4CAF50;
      cursor: pointer;
    }
  </style>
</head>
<!-- https://www.w3schools.com/howto/howto_js_rangeslider.asp -->
<!-- TODO: add loop button -->

<body>
  <div class="stagger-visualizer"></div>
  <div class='sliders'>

    <div class="slidecontainer">
      <div><span style="float: left">Width</span><span style="float:right" class='width-value'></span></div>
      <input type="range" min="350" max="650" value="450" class="slider" id="widthC">
    </div>
    <div class="slidecontainer">
      <div><span style="float: left">Height</span><span style="float:right" class='height-value'></span></div>
      <input type="range" min="350" max="650" value="450" class="slider" id="heightC">
    </div>
  </div>
  <button onclick="staggersAnimation.play()" class='loop btn btn-secondary'>Play Again</button>
  <script>
    const widthC = document.getElementById('widthC')
    const heightC = document.getElementById('heightC')
    const width = document.getElementsByClassName('width-value')
    const height = document.getElementsByClassName('height-value')
    const playAgain = document.querySelector('.loop')
    const staggerVisualizerEl = document.querySelector('.stagger-visualizer');
    const fragment = document.createDocumentFragment();
    const numberOfElements = 81;

    width[0].innerHTML = widthC.value + "px";
    height[0].innerHTML = heightC.value + "px";
    widthC.oninput = function () {
      width[0].innerText = this.value + "px";
      staggerVisualizerEl.style.width = this.value + "px";

    }
    heightC.oninput = function () {
      height[0].innerHTML = this.value + "px";
      staggerVisualizerEl.style.height = this.value + "px";
    }

    for (let i = 0; i < numberOfElements; i++) {
      fragment.appendChild(document.createElement('div'));

    }

    staggerVisualizerEl.appendChild(fragment);

    const staggersAnimation = anime.timeline({
      targets: '.stagger-visualizer div',
      easing: 'easeInOutSine',
      delay: anime.stagger(50),
      loop: false,
      autoplay: false,
      duration: 600,
      loopComplete: (a) => console.log('end'),
      //update: () => console.log(staggersAnimation.progress)
    })
      .add({
        rotate: anime.stagger(3, { from: 'center', direction: 'reverse', easing: 'easeInSine' }),
        translateX: 0,
        translateY: 0,
        delay: anime.stagger(10, { from: 'center' })
      })
    staggersAnimation.play();</script>
</body>

</html>